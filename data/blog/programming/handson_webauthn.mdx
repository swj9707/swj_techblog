---
title: 'ì‰½ê²Œ í’€ì–´ ì“´ WebAuthn'
date: '2025-04-11'
lastmod: '2025-04-11'
tags: ['Web', 'Programming', 'Security']
draft: false
summary: ìƒì²´ì¸ì¦ì„ ê°œë°œí•  ë•Œ ë§ì´ ì‚¬ìš©ë˜ëŠ” WebAuthn. ì œ ë‚˜ë¦„ëŒ€ë¡œ ìµœëŒ€í•œ ì‰½ê²Œ í’€ì–´ ì¨ ë³´ì•˜ìŠµë‹ˆë‹¤. 
---

![image](https://github.com/Danal-Crafters/crafters-journals/raw/main/2025-04/wj/img/webauthn-logo.png)

# Intro

ìƒì²´ì¸ì¦ ê¸°ëŠ¥ì„ ì¨ë³´ì…¨ì„ê±°ì—ìš”. IOSë¼ë©´ face id, Android ë¼ë©´ ì§€ë¬¸ì¸ì¦ ë“± ìƒì²´ ì •ë³´ë¥¼ í†µí•´ ì‹ ì›ì„ ì¸ì¦í•˜ëŠ” ê¸°ëŠ¥ì´ì£ . ì€í–‰ ë˜ëŠ” ì†¡ê¸ˆì•± ë“± ë‹¤ì–‘í•œ ê¸ˆìœµ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì´ëŸ° ê¸°ëŠ¥ë“¤ì„ ì œê³µí•˜ê³  ìˆì–´ìš”. 

ì™œ ì´ëŸ° ê¸°ëŠ¥ë“¤ì´ ì œê³µë ê¹Œìš”? íŒ¨ìŠ¤ì›Œë“œ ì¸ì¦ë§Œìœ¼ë¡œëŠ” ë¦¬ìŠ¤í¬ê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. íŒ¨ìŠ¤ì›Œë“œ ì¸ì¦ì€ íœ´ë¨¼ì—ëŸ¬ê°€ ë°œìƒí•˜ê¸° ì‰½ìŠµë‹ˆë‹¤. ìš°ë¦¬ê°€ íŒ¨ìŠ¤ì›Œë“œë¥¼ ìŠì„ ìˆ˜ë„ ìˆê³ , íŒ¨ìŠ¤ì›Œë“œê°€ ë„ˆë¬´ ì‰¬ìš°ë©´ í•´í‚¹ì„ í†µí•´ íƒˆì·¨ ë‹¹í•  ìˆ˜ë„ ìˆì£ . ìƒì²´ì¸ì¦ì€ ì´ëŸ° ë©´ì—ì„œ ì´ì ì„ ê°€ì§‘ë‹ˆë‹¤. íŒ¨ìŠ¤ì›Œë“œì— ì˜ì¡´í•˜ì§€ ì•Šì„ ìˆ˜ ìˆì£ . 

ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì›¹ í™˜ê²½ì—ì„œ ìƒì²´ì¸ì¦ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì¸ WebAuthn ì— ëŒ€í•´ ì•Œì•„ ë³´ê² ìŠµë‹ˆë‹¤. 

# Web Authentication API (WebAuthn)
WebAuthn ì— ëŒ€í•´ ì„¤ëª…í•˜ê¸° ì „ì— FIDO ì— ëŒ€í•´ ì•Œì•„ë´ì•¼ í•©ë‹ˆë‹¤. 

FIDO(Fast Identity Online) ì€ êµ­ì œ ì¸ì¦ í‘œì¤€ì…ë‹ˆë‹¤. ì•„ì´ë”” + ë¹„ë°€ë²ˆí˜¸ ë°©ì‹ ëŒ€ì‹  í™ì²´, ì–¼êµ´ì¸ì‹ ë“± ë‹¤ì–‘í•œ ìƒì²´ ì¸ì‹ ê¸°ë°˜ì˜ ì¸ì¦ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. 

FIDO ëŠ” í¬ê²Œ ì„¸ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤. 

- UAF
  - ì§€ë¬¸, ì–¼êµ´ ë“± ì‚¬ìš©ì ìƒì²´ì •ë³´ë¥¼ ì¸ì¦í•˜ëŠ” ëª¨ë°”ì¼ ì¤‘ì‹¬ì˜ ì¸ì¦ ë°©ì‹ì…ë‹ˆë‹¤.

- CTAP1 (U2F, Universal 2nd Factor)
  - ID / PW ë¥¼ í†µí•´ ìš°ì„  ë¡œê·¸ì¸ì„ í•©ë‹ˆë‹¤.
  - FIDO ì¸ì¦ ì‹œí—˜ì„ í†µê³¼í•œ ë³´ì•ˆ í‚¤ë¥¼ USB, ë¸”ë£¨íˆ¬ìŠ¤, NFC ë“±ì˜ ì™¸ë¶€ ê¸°ê¸°ì™€ ì—°ê²°í•´ PINì„ ì…ë ¥í•˜ëŠ” ì¶”ê°€ ì¸ì¦ì„ ì§„í–‰í•©ë‹ˆë‹¤.

- CTAP2
  - FIDO ë³´ì•ˆ í‚¤, ìƒì²´ ì¸ì‹ ì¥ì¹˜ ë“±ì„ í†µí•´ ì›¹ ë¸Œë¼ìš°ì €, OSì—ì„œ íŒ¨ìŠ¤ì›Œë“œ ì—†ëŠ” ì¸ì¦ì„ í•˜ëŠ” ë° ì‚¬ìš©í•©ë‹ˆë‹¤. 
  - CTAP1ì™€ ìœ ì‚¬í•˜ì§€ë§Œ PWê°€ ë”°ë¡œ ì—†ê³  ìƒì²´ì¸ì¦ìœ¼ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
  - CTAP2 ë¶€í„°ëŠ” WebAuthn ê³¼ í†µí•©í•´ì„œ ë¸Œë¼ìš°ì €, OS ë“±ì—ì„œ íŒ¨ìŠ¤ì›Œë“œë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

WebAuthn ì€ 2019ë…„ 3ì›” W3C ì›¹ í‘œì¤€ìœ¼ë¡œ ê³µì‹ ì¸ì •ë°›ì€ ì›¹ ê¸°ë°˜ API ì…ë‹ˆë‹¤. ì›¹ ì‚¬ì´íŠ¸ì— FIDO ê¸°ë°˜ ì¸ì¦ì„ ì¶”ê°€í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ì£ . ì›¹ ì„œë¹„ìŠ¤ëŠ” ì´ ê¸°ëŠ¥ì„ í†µí•´ ìƒì²´ì¸ì¦, ë˜ëŠ” FIDO ë³´ì•ˆ í‚¤ ì¸ì¦ì„ ì œê³µë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

WebAuthn ì€ ë‹¤ì–‘í•œ ë¸Œë¼ìš°ì € (Chrome, Firefox, Edge, Safari), ë° OS (Windows 10, Android) ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. IOS ë˜í•œ *passkeys* ê¸°ëŠ¥ì„ í†µí•´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

# íŒ¨ìŠ¤ì›Œë“œì— ë¹„í•´ ê°œì„ ëœ ì 
ê°€ì¥ ê²°ì •ì ìœ¼ë¡œ ìœ ì € ì…ì¥ì—ì„œ í¸ë¦¬í•˜ë‹¤ëŠ” ê²ƒ ì•„ë‹ê¹Œ ì‹¶ì–´ìš”. 

íŒ¨ìŠ¤ì›Œë“œë¥¼ ìƒì–´ë²„ë¦° ì  ë§ìœ¼ì‹œì£ ? ì „ ì •ë§ ë§ì´ ê¹Œë¨¹ê³  ìƒì–´ë²„ë¦½ë‹ˆë‹¤. WebAuthn ì„ ì‚¬ìš©í•˜ë©´, ìƒì²´ì¸ì¦ ë“±ìœ¼ë¡œ íŒ¨ìŠ¤ì›Œë“œë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆì–´ìš”. 

ë˜í•œ íŒ¨ìŠ¤ì›Œë“œëŠ” ì—¬ëŸ¬ ìœ„í—˜ì„±ì„ ê°€ì§‘ë‹ˆë‹¤. ì‘ì •í•˜ê³  ë¸Œë£¨íŠ¸í¬ìŠ¤ ê³µê²©ì„ í•˜ë©´ ì›¹ ì„œë¹„ìŠ¤ì— ë”°ë¼ì„  ìœ ì¶œ ë  ìˆ˜ ìˆê² ì£  (ë¬¼ë¡  íšŸìˆ˜ ì œí•œ ê¸°ëŠ¥ì„ êµ¬í˜„ í•´ ë‘ì–´ì•¼ê² ì§€ìš”?). ë˜í•œ íŒ¨ìŠ¤ì›Œë“œê°€ ì‹¬í”Œí•˜ë‹¤ë©´ ìœ ì¶œë˜ê¸° ì‰½ê² ì£ . 

WebAuthn ì€ ì´ëŸ° ë¬¸ì œì ì—ì„œ ììœ ë¡­ìŠµë‹ˆë‹¤. íƒ€ì¸ì´ ë¶€ì • ë¡œê·¸ì¸ì„ ì‹œë„í•˜ëŠ” ê²Œ êµ¬ì¡°ì ìœ¼ë¡œ ì‰½ì§€ ì•Šì£ . 

# ë™ì‘ê³¼ì •
![image](https://github.com/Danal-Crafters/crafters-journals/raw/main/2025-04/wj/img/fido2-reference-architecture.png)

WebAuthn ì€ FIDO2 ì‚¬ì–‘ì„ ì§€ì›í•©ë‹ˆë‹¤. FIDO2 ì—ì„œëŠ” ë‘ê°€ì§€ Option ì˜ Authenticatior ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. On Device í˜¹ì€ External Authenticator ì£ . ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ FIDO Authentication ìš”ì²­ì„ RP (Replying Party : ì•±ì„ ì‹¤í–‰ì¤‘ì´ê³ , FIDO ì¸ì¦ì„ ì§€ì›í•˜ëŠ” ì„œë²„) ì„œë²„ì— ìš”ì²­í•˜ê³  ì‘ë‹µí•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤. 

ì¢€ ë” ìì„¸íˆ FIDO2 ì¸ì¦ì´ ëŒì•„ê°€ëŠ” ê³¼ì •ì„ ì‚´í´ë³¼ê¹Œìš”?

![image](https://github.com/Danal-Crafters/crafters-journals/raw/main/2025-04/wj/img/fido2-registration-workflow.png)

FIDO2 ì¸ì¦ì„ êµ¬í˜„í•˜ë ¤ë©´ ë¨¼ì € ì¸ì¦ ì •ë³´ë¥¼ ë“±ë¡í•´ì•¼ê² ì£ . ìœ„ì˜ Workflow ë¥¼ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. 

- RP Server ì—ì„œ ë“±ë¡ ëœ Client ì™€ í†µì‹ í•˜ì—¬ CredentialID ìƒì„± ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤. 
  - ì´ ìš”ì²­ ì •ë³´ì—” ë‹¤ìŒ ì •ë³´ê°€ í¬í•¨ë©ë‹ˆë‹¤.
  - RP ID : ì„œë¹„ìŠ¤ ë„ë©”ì¸ ì´ë¦„(e.g., example.com).
  - Challenge : ê³ ìœ í•˜ê³  ì„ì˜ì˜ ê°’(ë³´ì•ˆì„±ì„ ìœ„í•´ ë§¤ë²ˆ ìƒˆë¡œ ìƒì„±).
  - UserInfo : ì‚¬ìš©ì ID ë° ì´ë¦„.
  - Options
    - Authenticator Selection ì‚¬ìš© ê°€ëŠ¥í•œ ì¸ì¦ ì¥ì¹˜ì˜ ì˜µì…˜(ì˜ˆ: ìƒì²´ì¸ì‹ ë˜ëŠ” PIN ì§€ì› ì—¬ë¶€)
    - Public Key Credential Parameters ì§€ì›ë˜ëŠ” ì•Œê³ ë¦¬ì¦˜(e.g., RSA, ECC)
  - ì´ ê³¼ì •ì—ì„œ RPId ê°€ Origin ê³¼ ë§ëŠ” ì§€ í™•ì¸í•©ë‹ˆë‹¤.
- Authenticator (WebAuthn ì´ë¼ë©´ ë¸Œë¼ìš°ì €ê² ì§€ìš”?) ì— RPID, UserId, Options, ClientData ë“±ì„ ì „ë‹¬í•´ì„œ Credential ìƒì„± ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤. 
- ìœ ì € ì¸ì¦ ì •ë³´ë¥¼ í™•ì¸ í•©ë‹ˆë‹¤ (ìƒì²´ì¸ì¦ ë“±ë¡ ì‹œ ì–¼êµ´ í˜¹ì€ ì§€ë¬¸ ìŠ¤ìº” ë“±)
- ì´í›„ KeyPair ë¥¼ ìƒì„±í•˜ê³ , ê·¸ ì¤‘ Private Keyë¥¼ RPId, CredentialIDì™€ í•¨ê»˜ Authenticator ì— ì €ì¥í•©ë‹ˆë‹¤. 
- Private Keyë¥¼ í†µí•´ ì„œëª… ëœ Attestation Object ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. RP ì„œë²„ì—ëŠ” Public Keyì™€ í•¨ê»˜ ì „ë‹¬í•©ë‹ˆë‹¤.
- RP ì„œë²„ëŠ” í•´ë‹¹ ì •ë³´ë¥¼ ì „ë‹¬ë°›ì€ í›„ ê²€ì¦í•©ë‹ˆë‹¤. (Origin, Challenge, Signature ë“±)
- ê²€ì¦ì´ ì„±ê³µí•˜ë©´ ìƒì„± ëœ ê³µê°œ í‚¤ë¥¼ ì‚¬ìš©ì ê³„ì •ê³¼ ì—°ê³„í•´ì„œ ì €ì¥í•©ë‹ˆë‹¤. ì•„ë§ˆ ê´€ë ¨ ëœ í…Œì´ë¸”ì„ ë”°ë¡œ ë‘ê±°ë‚˜ í•´ì•¼ê² ì£ . 

![image](https://github.com/Danal-Crafters/crafters-journals/raw/main/2025-04/wj/img/fide2-authentication-workflow.png)

ì¸ì¦ ì •ë³´ë¥¼ ë“±ë¡í–ˆìœ¼ë©´ í•œë²ˆ ì¸ì¦ì„ í•´ ë´ì•¼ê² ì£ ? ì¸ì¦ ê³¼ì •ì€ ì•„ë˜ì™€ ê°™ì´ ì´ë¤„ì§‘ë‹ˆë‹¤. 

- Client ê°€ RP Server ì— ì¸ì¦ ìš”ì²­ì„ ë³´ë‚´ë©´ ì•„ë˜ì˜ ì •ë³´ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤. 
  - RPID, CredentialID, Challenge
- ClientëŠ” Authenticator ì— í•´ë‹¹ ì •ë³´ë¥¼ í† ëŒ€ë¡œ RPID, UserId, clientData ë¡œ êµ¬ì„± ëœ ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤. 
- Authenticator ë‚´ë¶€ì˜ ì €ì¥ì†Œì—ì„œ CredentialIDë¥¼ ê¸°ì¤€ìœ¼ë¡œ PrivateKey ë¥¼ ê²€ìƒ‰ í•´ ì˜µë‹ˆë‹¤. 
- CreentialIDê°€ í•´ë‹¹ RPID ë¥¼ í†µí•´ ìƒì„± ë˜ì—ˆëŠ” ì§€ í™•ì¸í•œ í›„, ì‘ë‹µ ì •ë³´ë¥¼ Private Keyë¡œ ì„œëª…í•˜ì—¬ ì „ë‹¬í•©ë‹ˆë‹¤.  
  - ```authenticatorData = RP_ID_HASH + FLAGS + SIGNATURE_COUNTER + [OPTIONAL_DATA]``` 
  - RP_ID_HASH : SHA-256 í•´ì‹œê°’, RP ID ì™€ ì¼ì¹˜í•˜ëŠ” ì§€ í™•ì¸
  - FLAGS : ì¸ì¦ ê³¼ì •ì˜ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¹„íŠ¸ í•„ë“œ
  - Bit 0 : User Presence (UP) ì‚¬ìš©ìê°€ ì¥ì¹˜ì— ì§ì ‘ ì•¡ì…˜ì„ ì·¨í–ˆëŠ”ì§€ ì—¬ë¶€
  - Bit 2 : User Verified (UV) ì‚¬ìš©ìê°€ ë³¸ì¸ í™•ì¸ì„ ìˆ˜í–‰í–ˆëŠ”ì§€ ì—¬ë¶€
  - SIGNATURE_COUNTER : ì¸ì¦ê¸°ì˜ ì„œëª… ì¹´ìš´í„°. ì´ì „ ìš”ì²­ë³´ë‹¤ ì¦ê°€í–ˆëŠ”ì§€ í™•ì¸(ì¬ì‚¬ìš© ê³µê²© ë°©ì§€)
  - ATTESTATION CREDENTIAL DATA (Optional) : ë“±ë¡ ì¤‘ ì¸ì¦ê¸°ì—ì„œ ì œê³µí•œ ë°ì´í„°

ì „ë‹¬ ëœ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ RP ServerëŠ” ê²€ì¦ì„ ì§„í–‰í•©ë‹ˆë‹¤. 

# êµ¬í˜„ í•˜ëŠ” ë°©ë²•

![image](https://github.com/Danal-Crafters/crafters-journals/raw/main/2025-04/wj/img/webauthn-library-list.png)

[webauthn ê³µì‹ í™ˆí˜ì´ì§€](https://webauthn.io/)

ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ëŠ” ì–¸ì–´ë“¤ ë§ˆë‹¤ WebAuthn ì„ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ ì œê³µë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. 

Javaì—ì„œëŠ” ëŒ€í‘œì ìœ¼ë¡œ WebAuthn4j ê°€ ìˆìŠµë‹ˆë‹¤. ì €í¬ íŒ€ë„ WebAuthn4j ë¥¼ ì‚¬ìš©í–ˆì£ . 

ë¬¼ë¡  ì§ì ‘ êµ¬í˜„í•˜ì…”ë„ ì¢‹ìŠµë‹ˆë‹¤. ì¢‹ì€ ê³µë¶€ê°€ ë ê±°ì—ìš” ğŸ™‚!

ì•„ë§ˆ Java ìœ ì €ë“¤ì´ ë§ì€ ê´€ê³„ë¡œ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” WebAuthn4j ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª… í•´ë³¼ê¹Œ í•©ë‹ˆë‹¤. 

# WebAuthn4j

![image](https://github.com/Danal-Crafters/crafters-journals/raw/main/2025-04/wj/img/webauthn4j-logo.png)

WebAuthn4j ëŠ” Java ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ WebAuthn ì¸ì¦ì„ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. 

Spring Security ì™€ ì—°ë™ë„ ê°€ëŠ¥í•˜ì£ . ì‹¤ì œë¡œ Spring Security 6.4 ë¶€í„°ëŠ” passkey ë¥¼ ì§€ì›í•©ë‹ˆë‹¤. 

```kotlin
@Bean
open fun filterChain(http: HttpSecurity): SecurityFilterChain {
	http {
		webAuthn {
			rpName = "Spring Security Relying Party"
			rpId = "example.com"
			allowedOrigins = setOf("https://example.com")
		}
	}
}

@Bean
open fun userDetailsService(): UserDetailsService {
	val userDetails = User.withDefaultPasswordEncoder()
		.username("user")
		.password("password")
		.roles("USER")
		.build()
	return InMemoryUserDetailsManager(userDetails)
}
```

Webauthn4j ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ê´€ë¦¬ì¤‘ì¸ WebAuthn4j Spring Security ë¼ëŠ” í”„ë¡œì íŠ¸ë„ ì¡´ì¬í•˜ëŠ”ë°, Spring Securityì— WebAuthn ì§€ì› ê¸°ëŠ¥ì„ í™•ì¥ì‹œí‚¨ í˜•íƒœì…ë‹ˆë‹¤. 

ì²˜ìŒì— ê³µë¶€ê°€ ë¶€ì¡±í–ˆë˜ ìƒí™©ì—ì„œëŠ” WebAuthn4j Spring Security ë¥¼ ì—´ì‹¬íˆ ëœ¯ì–´ê³ ì¹˜ë‹¤ê°€, WebAuthn4j Core ë§Œ ê°€ì§€ê³  ê¸°ëŠ¥ì„ êµ¬í˜„ í–ˆì—ˆì£ .  

WebAuthn4j Spring Security ëŠ” ê¸°ì¡´ì˜ Spring Security ì— ì—ë“œì˜¨ì„ ì¶”ê°€ í•œ ë§Œí¼ ê¸°ì¡´ì— ì‚¬ìš©ì¤‘ì¸ Spring Security ì…‹ì—…ì— ì˜í–¥ì„ ë¼ì¹  ìˆ˜ ìˆê¸°ì— ì‚¬ìš©í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. 

## ì˜ˆì œ í”„ë¡œì íŠ¸

ê°„ë‹¨í•˜ê²Œ WebAuthn4j ë¥¼ í†µí•´ Spring Boot ì™€ React ë¥¼ ê²°í•©í•œ ì¸ì¦ ì•±ì„ ê°œë°œ í•´ ë³´ê² ìŠµë‹ˆë‹¤. 
WebAuthn4j-core 0.28.6 ë²„ì „ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤. 

### Backend
```kotlin
dependencies {
    implementation("org.springframework.boot:spring-boot-starter-web")
    implementation("org.springframework.boot:spring-boot-starter-security")
    implementation("com.fasterxml.jackson.module:jackson-module-kotlin")
    implementation("com.webauthn4j:webauthn4j-core:0.28.6.RELEASE") 
}
```
ë¨¼ì € WebAuthn4j ë¥¼ ìš°ë¦¬ì˜ Spring Boot í”„ë¡œì íŠ¸ì— ì…‹ì—… í•©ë‹ˆë‹¤. 

```shell
src/
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ WebAuthnController.kt
â”œâ”€â”€ dto/
â”‚   â”œâ”€â”€ RegistrationFinishRequest.kt
â”‚   â””â”€â”€ AssertionFinishRequest.kt
â”œâ”€â”€ store/
â”‚   â”œâ”€â”€ ChallengeService.kt
â”‚   â””â”€â”€ UserStorage.kt
```
í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ì˜ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ê°„ë‹¨í•˜ê²Œ ì‘ì„± í•´ ë³´ì•˜ì–´ìš”. 

```kotlin
@Configuration
@EnableWebSecurity
class SecurityConfig {

    @Bean
    fun filterChain(http: HttpSecurity): SecurityFilterChain {
        http.csrf().disable()
            .authorizeRequests()
            .antMatchers("/api/webauthn/**").permitAll()
            .anyRequest().authenticated()
    }
}
```
ë‹¤ìŒìœ¼ë¡œ Spring Security filterChain ì…‹ì—…ì„ í•©ë‹ˆë‹¤. WebAuthn ìš”ì²­ ì™¸ì— ëª¨ë“  ìš”ì²­ë“¤ì— ëŒ€í•´ Authenticated ì˜µì…˜ì„ ì¤ë‹ˆë‹¤. 

```kotlin
package com.example.dto

data class RegistrationFinishRequest(
    val username: String,
    val id: ByteArray,
    val rawId: ByteArray,
    val type: String,
    val response: AttestationResponse
)

data class AttestationResponse(
    val clientDataJSON: ByteArray,
    val attestationObject: ByteArray
)
```
```kotlin
package com.example.dto

data class AssertionFinishRequest(
    val username: String,
    val id: ByteArray,
    val rawId: ByteArray,
    val response: AssertionResponse,
    val type: String,
    val clientExtensionResults: Map<String, Any>? = null
)

data class AssertionResponse(
    val clientDataJSON: ByteArray,
    val authenticatorData: ByteArray,
    val signature: ByteArray,
    val userHandle: ByteArray? = null
)
```
ë¨¼ì € DTO (VO) ì…ë‹ˆë‹¤. ë“±ë¡, ê·¸ë¦¬ê³  ì¸ì¦ì— ì‚¬ìš©ë˜ëŠ” ìš”ì²­ ì‘ë‹µ ì •ë³´ë“¤ì…ë‹ˆë‹¤. 

```kotlin
package com.example.store

import com.webauthn4j.data.attestation.authenticator.Authenticator
import org.springframework.stereotype.Component
import java.util.concurrent.ConcurrentHashMap

@Component
class UserStorage {
    private val map = ConcurrentHashMap<String, Authenticator>()

    fun save(username: String, authenticator: Authenticator) {
        map[username] = authenticator
    }

    fun get(username: String): Authenticator? {
        return map[username]
    }
}
```
ì›ë˜ëŒ€ë¡œë¼ë©´ JPA Repository ë¥¼ ì—°ë™í•˜ëŠ” ë“± ì§ì ‘ DB ì™€ ì—°ë™í•´ì•¼ê² ì§€ë§Œ, ì˜ˆì‹œ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì¸ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. 

```kotlin
package com.example.store

import com.webauthn4j.data.client.challenge.Challenge
import com.webauthn4j.data.client.challenge.DefaultChallenge
import org.springframework.stereotype.Service
import java.util.concurrent.ConcurrentHashMap

@Service
class ChallengeService {
    private val challengeMap = ConcurrentHashMap<String, Challenge>()

    fun generate(username: String): Challenge {
        val challenge = DefaultChallenge()
        challengeMap[username] = challenge
        return challenge
    }

    fun get(username: String): Challenge? = challengeMap[username]

    fun clear(username: String) {
        challengeMap.remove(username)
    }
}
```
ë‹¤ìŒìœ¼ë¡œ ChallengeService ì…ë‹ˆë‹¤. ìœ ì €ë§ˆë‹¤ í• ë‹¹ ëœ Challenge ê°’ì„ ì €ì¥í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.  
ì´ Challenge ê°’ ë˜í•œ ì œëŒ€ë¡œ êµ¬ì„±í•˜ë ¤ë©´ DBë¡œ êµ¬ì„±í•´ì•¼ í•©ë‹ˆë‹¤. 


```kotlin
package com.example.controller

import com.example.dto.AssertionFinishRequest
import com.example.dto.RegistrationFinishRequest
import com.example.store.ChallengeService
import com.example.store.UserStorage
import com.webauthn4j.WebAuthnManager
import com.webauthn4j.data.*
import com.webauthn4j.data.attestation.authenticator.Authenticator
import com.webauthn4j.data.client.Origin
import com.webauthn4j.data.client.challenge.Challenge
import com.webauthn4j.data.client.challenge.DefaultChallenge
import com.webauthn4j.data.extension.client.AuthenticationExtensionsClientInputs
import org.springframework.web.bind.annotation.*
import java.util.*

@RestController
@RequestMapping
class WebAuthnController(
    private val challengeService: ChallengeService,
    private val userStorage: UserStorage
) {
    private val manager = WebAuthnManager.createNonStrictWebAuthnManager()

    @PostMapping("/api/webauthn/register/options")
    fun registerOptions(@RequestBody username: String): PublicKeyCredentialCreationOptions {
        //Do Something
    }

    @PostMapping("/api/webauthn/register/finish")
    fun registerFinish(@RequestBody req: RegistrationFinishRequest): String {
        //Do Something
    }

    @PostMapping("/api/webauthn/login/options")
    fun loginOptions(@RequestBody username: String): PublicKeyCredentialRequestOptions {
        //Do Something
    }

    @PostMapping("/api/webauthn/login/finish")
    fun loginFinish(@RequestBody req: AssertionFinishRequest): String {
        //Do Something
    }
}

```
ë‹¤ìŒìœ¼ë¡œ WebAuthn ì‚¬ìš©ì ë“±ë¡ ì ˆì°¨ë¥¼ ì²˜ë¦¬í•˜ëŠ” Controller ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.  
ì—¬ê¸°ì„œ ì¤‘ìš”í•œ í•„ë“œ ê°’ë“¤ì„ í•œë²ˆ ì§šê³  ê°€ê² ìŠµë‹ˆë‹¤. 

```kotlin
private val manager = WebAuthnManager.createNonStrictWebAuthnManager()
```
`WebAuthnManager` ëŠ” WebAuthn ìš”ì²­ì„ ê²€ì¦í•˜ëŠ” í•µì‹¬ í´ë˜ìŠ¤ì…ë‹ˆë‹¤. í˜„ì¬ëŠ” í…ŒìŠ¤íŠ¸ìš©ì´ë¯€ë¡œ NonStrict ëª¨ë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. 

```kotlin
@PostMapping("/api/webauthn/register/options")
fun startRegistration(@RequestBody username: String): PublicKeyCredentialCreationOptions {
    val challenge = challengeService.generate(username)
    val user = UserIdentity(
        id = UUID.nameUUIDFromBytes(username.toByteArray()).toString().toByteArray(),
        name = username,
        displayName = username
    )

    return PublicKeyCredentialCreationOptions(
        rp = RelyingPartyIdentity("localhost", "My WebAuthn App"),
        user = user,
        challenge = challenge,
        pubKeyCredParams = listOf(PublicKeyCredentialParameters("public-key", COSEAlgorithmIdentifier.ES256)),
        timeout = 60000L,
        excludeCredentials = emptyList(),
        authenticatorSelection = AuthenticatorSelectionCriteria(null, false, UserVerificationRequirement.PREFERRED),
        attestation = AttestationConveyancePreference.NONE,
        extensions = RegistrationExtensionsClientInputs()
    )
}
```
startRegistration ë©”ì†Œë“œëŠ” ì‚¬ìš©ìê°€ ë“±ë¡ ìš”ì²­ì„ ë³´ë‚¼ ë•Œ í˜¸ì¶œ ë˜ëŠ” ë©”ì†Œë“œì…ë‹ˆë‹¤. 

ë“±ë¡ ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ë•Œ ì‚¬ìš©ì ë³„ë¡œ ìƒˆë¡œìš´ Challenge ë¥¼ ìƒì„±í•˜ê³  ì €ì¥í•©ë‹ˆë‹¤.  
ê·¸ í›„ ìƒˆë¡œìš´ ì‚¬ìš©ì ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì‚¬ìš©ì ëª©ë¡ì— ì¶”ê°€í•©ë‹ˆë‹¤.  
ë§ˆì§€ë§‰ìœ¼ë¡œ `PublicKeyCredentialCreationOptions` ë¥¼ í†µí•´ option ì •ë³´ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤. 

- rp : Relying Party ì •ë³´ ì„¤ì • (ID, Name)
- user : ì‚¬ìš©ì ì •ë³´ ì„¤ì • (UserIdentity ê°ì²´)
- pubKeyCredParams: ì‚¬ìš©í•  ì•Œê³ ë¦¬ì¦˜ ì§€ì • (ES256 ì‚¬ìš©)
- timeout : ìš”ì²­ ë§Œë£Œ ì‹œê°„
- excludeCredentials ì´ë¯¸ ë“±ë¡ ëœ ì¸ì¦ê¸° ëª©ë¡, ì¤‘ë³µ ë“±ë¡ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤. 
- authenticatorSelection: ì¸ì¦ê¸° ì„ íƒ ê¸°ì¤€
- attestation: ì¸ì¦ ì¥ì¹˜ì˜ ì‹ ë¢°ë¥¼ í™•ì¸í•  ë•Œ DIRECT ëª¨ë“œë¥¼ ì‚¬ìš©
- extensions : Webauthn í™•ì¥ì„ ìœ„í•œ ì˜µì…˜ (ì˜ˆ : ì¸ì¦ê¸° ì´ë¦„, device bound) ì¼ë°˜ì ìœ¼ë¡œ ë¹„ì›ë‹ˆë‹¤.

```kotlin
@PostMapping("/api/webauthn/register/finish")
fun finishRegistration(@RequestBody request: RegistrationFinishRequest): String {
    val challenge = challengeService.get(req.username) ?: error("Challenge not found")

    val credential = RegistrationRequest(
        credentialId = req.id,
        clientDataJSON = req.response.clientDataJSON,
        attestationObject = req.response.attestationObject,
        clientExtensionsJSON = null
    )

    val parameters = RegistrationParameters(
        challenge = challenge,
        origin = Origin("http://localhost:3000"),
        rpId = "localhost",
        userVerificationRequired = false
    )

    val result = manager.validate(credential, parameters)
    val authenticator = result.attestationObject.authenticatorData.attestedCredentialData
        ?: error("Attested credential missing")
    val stored = Authenticator(
        credentialId = req.id,
        attestedCredentialData = authenticator,
        counter = result.attestationObject.authenticatorData.signCount
    )

    userStorage.save(req.username, stored)
    challengeService.clear(req.username)
    return "Registration success"
}
```
finishRegistration ì€ ë“±ë¡ì„ ì™„ë£Œí•˜ê¸° ìœ„í•´ í˜¸ì¶œë˜ëŠ” ë©”ì†Œë“œì…ë‹ˆë‹¤. Frontend ì—ì„œ ì „ë‹¬í•œ Request ë¥¼ WebAuthn4j ê°€ ìš”êµ¬í•˜ëŠ” RegistrationRequest ê°ì²´ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. RegistrationParameters ì—ëŠ” ê²€ì¦ì— í•„ìš”í•œ ì¶”ê°€ ì •ë³´ (rpId, origin) ì •ë³´ë¥¼ ë„£ìŠµë‹ˆë‹¤. origin ì€ ë¸Œë¼ìš°ì €ì—ì„œ ìš”ì²­ì„ ë³´ë‚¸ ì¶œì²˜ì™€ ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•˜ê³ , rpId ëŠ” ì„œë²„ì— ë“±ë¡ ëœ ì˜µì…˜ê³¼ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤. 

ê·¸ í›„ WebAuthn4j ë‚´ë¶€ ë¡œì§ìœ¼ë¡œ ë“±ë¡ ì‘ë‹µì„ ê²€ì¦í•©ë‹ˆë‹¤. ê·¸ í›„ authenticator ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ”ë°, ê²€ì¦ì´ ì„±ê³µí•œë‹¤ë©´ ì¸ì¦ê¸°ì˜ ì‹ë³„ì, ê³µê°œí‚¤ ë“± ì •ë³´ë¥¼ í¬í•¨í•´ì„œ ìƒì„±í•©ë‹ˆë‹¤. 

ì¸ì¦ê¸° ì •ë³´ë¥¼ ë“±ë¡ ìš”ì²­ì„ ë³´ë‚¸ ì‚¬ìš©ì ê¸°ì¤€ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤. challenge ê°’ì€ ì¼íšŒì„±ì´ë¯€ë¡œ ë“±ë¡ í›„ ì œê±°í•©ë‹ˆë‹¤. 

```kotlin
@PostMapping("/api/webauthn/login/options")
fun loginOptions(@RequestBody username: String): PublicKeyCredentialRequestOptions {
    val challenge = challengeService.generate(username)
    val authenticator = userStorage.get(username) ?: error("User not found")

    val allow = listOf(
        PublicKeyCredentialDescriptor(
            type = PublicKeyCredentialType.PUBLIC_KEY,
            id = authenticator.credentialId,
            transports = null
        )
    )

    return PublicKeyCredentialRequestOptions(
        challenge = challenge,
        timeout = 60000L,
        rpId = "localhost",
        allowCredentials = allow,
        userVerification = UserVerificationRequirement.PREFERRED,
        extensions = AuthenticationExtensionsClientInputs()
    )
}
```
ì´ì œ ë¡œê·¸ì¸ì„ í•´ ë´ì•¼ì£ ? loginOptions ë©”ì†Œë“œì—ì„œëŠ” Frontend ì—ê²Œ ë¡œê·¸ì¸ì— í•„ìš”í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. 

ìš”ì²­ ë°›ì€ ìœ ì € ì •ë³´ë¥¼ ë©”ëª¨ë¦¬ì—ì„œ ì°¾ìŠµë‹ˆë‹¤. ê·¸ í›„ challenge ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 
ë‹¤ìŒìœ¼ë¡œ ì‚¬ìš©ìê°€ ë“±ë¡í•œ ì¸ì¦ê¸° ëª©ë¡ì„ ì¶”ì¶œí•©ë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ PublicKeyCredentialDescriptor ë¥¼ ì‚¬ìš©í•´ì„œ ê° ì¸ì¦ê¸°ì˜ ID (Credential ID) ë¥¼ í¬í•¨ ì‹œí‚µë‹ˆë‹¤. 

ë§ˆì§€ë§‰ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ ì‚¬ìš© í•  ì¸ì¦ ì˜µì…˜ PublicKeyCredentialRequestOptions ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 
ì£¼ìš” ì˜µì…˜ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. 

- challenge: í´ë¼ì´ì–¸íŠ¸ê°€ ì„œëª…í•  ë°ì´í„° (ëœë¤ìœ¼ë¡œ ìƒì„±ë¨)
- rpId: Relying Partyì˜ ë„ë©”ì¸ (ì´ ê²½ìš° localhost)
- allowCredentials: ì‚¬ìš©ìê°€ ë“±ë¡í•œ ì¸ì¦ê¸° ëª©ë¡ (í—ˆìš©ëœ ì¸ì¦ê¸°ë“¤)
- timeout: ì¸ì¦ ê³¼ì •ì˜ ìµœëŒ€ í—ˆìš© ì‹œê°„ (ë°€ë¦¬ì´ˆ)
- userVerification: ì‚¬ìš©ìê°€ ì¸ì¦ ê³¼ì •ì—ì„œ ìƒì²´ ì¸ì¦ ë˜ëŠ” PIN ì…ë ¥ì„ ìš”êµ¬í• ì§€ ì„¤ì • (PREFERRED ë¡œ ì„¤ì •)

```kotlin
@PostMapping("/api/webauthn/login/finish")
fun loginFinish(@RequestBody req: AssertionFinishRequest): String {
val challenge = challengeService.get(req.username) ?: error("Challenge not found")
    val authenticator = userStorage.get(req.username) ?: error("Authenticator not found")

    val credential = AuthenticationRequest(
        credentialId = req.id,
        clientDataJSON = req.response.clientDataJSON,
        authenticatorData = req.response.authenticatorData,
        signature = req.response.signature,
        clientExtensionsJSON = null
    )

    val parameters = AuthenticationParameters(
        challenge = challenge,
        origin = Origin("http://localhost:3000"),
        rpId = "localhost",
        authenticator = authenticator,
        userVerificationRequired = false
    )

    manager.validate(credential, parameters)
    challengeService.clear(req.username)
    return "Login success"
}
```
ë§ˆì§€ë§‰ìœ¼ë¡œ ë¡œê·¸ì¸ ê²€ì¦ì…ë‹ˆë‹¤. 

ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ ìš”ì²­ì„ ë³´ë‚´ë©´ì„œ ìƒì„±í–ˆë˜ Challenge ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ë§Œì•½ í•´ë‹¹ Challenge ê°€ ì—†ê±°ë‚˜ ë§Œë£Œëœ ê²½ìš° ì˜ˆì™¸ê°€ ë°œìƒí•©ë‹ˆë‹¤. 

ë‹¤ìŒìœ¼ë¡œ ì‚¬ìš©ìê°€ ë“±ë¡í•œ ì¸ì¦ê¸° (authenticator) ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤. ì¸ì¦ê¸° ID (ì—¬ê¸°ì„œëŠ” username) ê°€ ì‚¬ìš©ìì˜ ì¸ì¦ê¸° ëª©ë¡ì— ì—†ìœ¼ë©´ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.

ë‹¤ìŒìœ¼ë¡œ ì¸ì¦ ìš”ì²­ì„ ê²€ì¦í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” AuthenticationParameters ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. Origin ì€ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì˜ ì¶œì²˜ë¥¼ ì˜ë¯¸í•˜ë©°, http://localhost:3000 ìœ¼ë¡œ ì„¤ì • í•©ë‹ˆë‹¤. 

WebAuthnManager ë¥¼ í†µí•´ ê²€ì¦ì„ ìˆ˜í–‰í•˜ê³  ì„±ê³µí•˜ë©´ ì¸ì¦ì´ ì™„ë£Œë©ë‹ˆë‹¤. 

### Frontend
React ì—ì„œ @simplewebauthn/browser ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•´ì„œ WebAuthn ì¸ì¦ì„ êµ¬í˜„ í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì„¤ëª… í¸ì˜ ìƒ ì˜ˆì œ ì½”ë“œëŠ” Typescript ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. 

```shell
npm install axios @simplewebauthn/browser react-router-dom
npm install --save-dev @types/react-router-dom
```

```typescript
export interface PublicKeyCredentialCreationOptionsJSON {
  challenge: string;
  rp: { name: string; id: string };
  user: { id: string; name: string; displayName: string };
  pubKeyCredParams: { type: string; alg: number }[];
  timeout?: number;
  attestation?: string;
  authenticatorSelection?: {
    authenticatorAttachment?: string;
    requireResidentKey?: boolean;
    userVerification?: string;
  };
}

export interface PublicKeyCredentialRequestOptionsJSON {
  challenge: string;
  rpId: string;
  allowCredentials?: Array<{
    id: string;
    type: string;
    transports?: string[];
  }>;
  timeout?: number;
  userVerification?: 'required' | 'preferred' | 'discouraged';
}
```

ë¨¼ì € ì˜µì…˜ì˜ í˜•íƒœë¥¼ interface ë¡œ ì •ì˜í•©ë‹ˆë‹¤. 

PublicKeyCredentialCreationOptionsJSON ëŠ” WebAuthn ë“±ë¡ ê³¼ì •ì—ì„œ ë¸Œë¼ìš°ì €ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê°ì²´ ì…ë‹ˆë‹¤. 
ë¸Œë¼ìš°ì €ê°€ ì¸ì¦ê¸°ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì •ë³´ë“¤ì„ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. 

PublicKeyCredentialRequestOptionsJSON ì€ ì„œë²„ì—ì„œ ì œê³µí•˜ëŠ” ë¡œê·¸ì¸ ì˜µì…˜ì˜ íƒ€ì… ì •ì˜ì…ë‹ˆë‹¤. 
- allowCredentials: ì‚¬ìš©ìê°€ ë“±ë¡í•œ ì¸ì¦ê¸°ì˜ ì •ë³´ ë¦¬ìŠ¤íŠ¸.
- challenge: ë¬´ì‘ìœ„ë¡œ ìƒì„±ëœ ë°”ì´íŠ¸ ë°°ì—´ì„ base64urlë¡œ ì¸ì½”ë”©í•œ ê°’.
- rpId: Relying Party ID (ì˜ˆ: localhost).
- userVerification: ì‚¬ìš©ì ê²€ì¦ ìš”êµ¬ ìˆ˜ì¤€ (preferred, required, discouraged)

```jsx
import React, { useState } from 'react';
import axios from 'axios';
import { startRegistration, RegistrationResponseJSON } from '@simplewebauthn/browser';
import { PublicKeyCredentialCreationOptionsJSON } from '../types/webauthn';

const RegisterPage: React.FC = () => {
  const [username, setUsername] = useState('');

  const handleRegister = async () => {
    try {
      const optionsRes = await axios.post<PublicKeyCredentialCreationOptionsJSON>(
        '/api/webauthn/register/options',
        username,
        { headers: { 'Content-Type': 'application/json' } }
      );

      const attestationResponse: RegistrationResponseJSON = await startRegistration(optionsRes.data);

      const payload = {
        username,
        id: attestationResponse.id,
        rawId: attestationResponse.rawId,
        type: attestationResponse.type,
        response: {
          clientDataJSON: attestationResponse.response.clientDataJSON,
          attestationObject: attestationResponse.response.attestationObject,
        },
      };

      await axios.post('/api/webauthn/register/finish', payload);
      alert('Registration complete');
    } catch (e) {
      console.error(e);
      alert('Registration failed');
    }
  };

  return (
    <div>
      <h2>Register</h2>
      <input
        placeholder="Username"
        value={username}
        onChange={(e) => setUsername(e.target.value)}
      />
      <button disabled={!username} onClick={handleRegister}>
        Register with Passkey
      </button>
    </div>
  );
};

export default RegisterPage;
```
ì„œë²„ë¡œ ë¶€í„° `/api/webauthn/register/options/` ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤. ê·¸ í›„ WebAuthn ì¸ì¦ê¸°ë¥¼ í˜¸ì¶œí•´ì„œ ë“±ë¡ì„ ìˆ˜í–‰í•˜ëŠ”ë°, `startRegistration` í•¨ìˆ˜ëŠ” `RegistrationResponseJSON` íƒ€ì…(ë¼ì´ë¸ŒëŸ¬ë¦¬ ì œê³µ)ì˜ ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. 

ë§ˆì§€ë§‰ìœ¼ë¡œ ì¸ì¦ ì •ë³´ë¥¼ ì„œë²„ë¡œ ë³´ë‚´ ê²€ì¦ì„ ìš”ì²­í•©ë‹ˆë‹¤. ì„œë²„ì—ì„œ í•´ë‹¹ ë°ì´í„°ë¥¼ ê²€ì¦í•˜ê³  ì‚¬ìš©ì ì •ë³´ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. 

```jsx
import React, { useState } from 'react';
import axios from 'axios';
import { startAuthentication, AuthenticationResponseJSON } from '@simplewebauthn/browser';
import { PublicKeyCredentialRequestOptionsJSON } from '../types/webauthn';
import { useNavigate } from 'react-router-dom';

const LoginPage: React.FC = () => {
  const [username, setUsername] = useState('');
  const navigate = useNavigate();

  const handleLogin = async () => {
    try {
      const optionsRes = await axios.post<PublicKeyCredentialRequestOptionsJSON>(
        '/api/webauthn/login/options',
        username,
        { headers: { 'Content-Type': 'application/json' } }
      );

      const assertionResponse: AuthenticationResponseJSON = await startAuthentication(optionsRes.data);

      const payload = {
        username,
        id: assertionResponse.id,
        rawId: assertionResponse.rawId,
        response: {
          clientDataJSON: assertionResponse.response.clientDataJSON,
          authenticatorData: assertionResponse.response.authenticatorData,
          signature: assertionResponse.response.signature,
          userHandle: assertionResponse.response.userHandle,
        },
        type: assertionResponse.type,
        clientExtensionResults: assertionResponse.clientExtensionResults,
      };

      await axios.post('/api/webauthn/login/finish', payload);
      alert('Login successful');
      navigate('/main');
    } catch (e) {
      console.error(e);
      alert('Login failed');
    }
  };

  return (
    <div>
      <h2>Login</h2>
      <input
        placeholder="Username"
        value={username}
        onChange={(e) => setUsername(e.target.value)}
      />
      <button disabled={!username} onClick={handleLogin}>
        Login with Passkey
      </button>
    </div>
  );
};

export default LoginPage;
```
ë‹¤ìŒìœ¼ë¡œ ë¡œê·¸ì¸ì…ë‹ˆë‹¤.

ì‚¬ìš©ìê°€ ì…ë ¥ í•œ username ì„ ì„œë²„ë¡œ ë³´ë‚´ê³  ì„œë²„ëŠ” ì‚¬ìš©ìì˜ ë“±ë¡ëœ ì¸ì¦ê¸°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¡œê·¸ì¸ ì˜µì…˜ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

ë¸Œë¼ìš°ì €ì—ì„œ ì¸ì¦ê¸°ë¥¼ í˜¸ì¶œí•˜ì—¬ ì¸ì¦ì„ ì§„í–‰í•©ë‹ˆë‹¤. ì¸ì¦ê¸°ê°€ ì„±ê³µí•˜ë©´ `AuthenticationResponseJSON` íƒ€ì…ì˜ ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. 

ë‹¤ìŒìœ¼ë¡œ ì¸ì¦ ê²°ê³¼ë¥¼ ì„œë²„ë¡œ ë³´ë‚´ ê²€ì¦ì„ ìš”ì²­í•©ë‹ˆë‹¤. ì„œë²„ì—ì„œ ì´ ë°ì´í„°ë¥¼ ê²€ì¦í•˜ì—¬ ì‚¬ìš©ìì˜ ì¸ì¦ ì„±ê³µ ì—¬ë¶€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤. 

```jsx
import React from 'react';
import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';
import RegisterPage from './pages/RegisterPage';
import LoginPage from './pages/LoginPage';

const MainPage: React.FC = () => (
  <div>
    <h1>Welcome ğŸ‰</h1>
  </div>
);

const App: React.FC = () => {
  return (
    <Router>
      <Routes>
        <Route path="/" element={<RegisterPage />} />
        <Route path="/login" element={<LoginPage />} />
        <Route path="/main" element={<MainPage />} />
        <Route path="*" element={<Navigate to="/" />} />
      </Routes>
    </Router>
  );
};

export default App;
```
ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœ ìƒìœ„ App.tsx ì…ë‹ˆë‹¤. ê°„ë‹¨í•˜ê²Œ ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ í…ŒìŠ¤íŠ¸ í•´ ë³¼ ìˆ˜ ìˆì„ê±°ì—ìš”. 

# Outro
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” FIDO, WebAuthn ì— ëŒ€í•´ ìµœëŒ€í•œ í’€ì–´ì„œ ì •ë¦¬ í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. 

ë§ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìƒì²´ì¸ì¦ì„ ì œê³µí•˜ê³ , íŠ¹íˆ ì›¹ë·° ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ì´ëŸ° í˜•íƒœë¡œ ì¸ì¦ì„ êµ¬í˜„ í–ˆì„ ê²ƒì…ë‹ˆë‹¤. ì¶”í›„ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìƒì²´ì¸ì¦ ë“±ì„ êµ¬í˜„í•  ë•Œ WebAuthn ì„ í™œìš©í•´ë³´ì‹œëŠ” ê²Œ ì–´ë–¨ê¹Œìš”?

# Reference

[FIDO](https://fido.kica.co.kr/)  
[FIDO2: ì›¹ ì¸ì¦(WebAuthn) - FIDO Alliance](https://fidoalliance.org/fido2-2/fido2-web-authentication-webauthn/?lang=ko)  
[Web Authentication: An API for accessing Public Key Credentials - Level 2](https://www.w3.org/TR/webauthn/)   
[A demonstration of the WebAuthn specification](https://webauthn.io/)